<UserControl x:Class="ProcessMonitor.UserControls.ProcessListControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Background="White">
    <!-- RootGrid bierze ProcessListViewModel z MainViewModel -->
    <Grid x:Name="RootGrid"
          DataContext="{Binding ProcessListViewModel}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Opcje Filtrowania/Sortowania -->
        <Grid Grid.Row="0" Background="#F0F0F0" Margin="0">
            <StackPanel Orientation="Horizontal" Margin="10,10,10,10">
                <TextBlock Text="Filtruj:" VerticalAlignment="Center" FontWeight="Bold" Margin="0,0,10,0"/>
                <TextBox Text="{Binding FilterText, UpdateSourceTrigger=PropertyChanged}" 
                         Width="150" Padding="5" BorderThickness="1" BorderBrush="#CCC"/>

                <TextBlock Text="Sortuj:" VerticalAlignment="Center" FontWeight="Bold" Margin="20,0,0,0"/>
                <ComboBox SelectedItem="{Binding SortBy}" Width="120" Padding="5" Margin="10,0,0,0">
                    <System:String xmlns:System="clr-namespace:System;assembly=mscorlib">Name</System:String>
                    <System:String xmlns:System="clr-namespace:System;assembly=mscorlib">Memory</System:String>
                    <System:String xmlns:System="clr-namespace:System;assembly=mscorlib">PID</System:String>
                    <System:String xmlns:System="clr-namespace:System;assembly=mscorlib">Threads</System:String>
                </ComboBox>
            </StackPanel>
        </Grid>

        <!-- Przycisk odświeżenia i auto-refresh -->
        <Grid Grid.Row="1" Background="#F0F0F0" Margin="0">
            <StackPanel Orientation="Horizontal" Margin="10,10,10,10">
                <Button Command="{Binding RefreshCommand}"
                        Padding="10,5"
                        Background="#0078D4"
                        Foreground="White"
                        Margin="0,0,10,0"
                        Content="Odśwież teraz"/>

                <CheckBox IsChecked="{Binding IsAutoRefreshing}" VerticalAlignment="Center" Margin="0,0,10,0">
                    <TextBlock Text="Automatyczne odświeżanie co "/>
                </CheckBox>

                <TextBox Text="{Binding RefreshIntervalMs}" Width="50" Padding="5"
                         BorderThickness="1" BorderBrush="#CCC" Margin="0,0,5,0"/>
                <TextBlock Text="ms" VerticalAlignment="Center"/>
            </StackPanel>
        </Grid>

        <!-- Lista procesów -->
        <DataGrid Grid.Row="2"
                  ItemsSource="{Binding Processes}" 
                  SelectedItem="{Binding SelectedProcess}"
                  AutoGenerateColumns="False" CanUserAddRows="False"
                  BorderThickness="1" BorderBrush="#CCC" Margin="0,0,0,0">
            <DataGrid.Columns>
                <DataGridTextColumn Header="PID" Binding="{Binding ProcessId}" Width="70"/>
                <DataGridTextColumn Header="Nazwa" Binding="{Binding ProcessName}" Width="200"/>
                <DataGridTextColumn Header="Wątki" Binding="{Binding ThreadCount}" Width="70"/>
                <DataGridTextColumn Header="Pamięć (MB)" 
                                    Binding="{Binding WorkingSet, StringFormat='{}{0:N0}'}" 
                                    Width="100"/>
                <DataGridTextColumn Header="Priorytet" Binding="{Binding Priority}" Width="80"/>
                <DataGridTextColumn Header="Ścieżka" Binding="{Binding ProcessPath}" Width="300"/>
            </DataGrid.Columns>
        </DataGrid>

        <!-- Przyciski akcji -->
        <Grid Grid.Row="3" Background="#F0F0F0" Margin="0">
            <StackPanel Orientation="Horizontal" Margin="10,10,10,10">
                <Button Command="{Binding DataContext.StartMonitoringCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                        Padding="10,5"
                        Background="#107C10" Foreground="White" Margin="0,0,10,0">
                    Śledź proces
                </Button>

                <Button Command="{Binding KillProcessCommand}" Padding="10,5"
                        Background="#D13438" Foreground="White" Margin="0,0,10,0">
                    Zabij proces
                </Button>

                <ComboBox x:Name="PriorityCombo" Width="150" Padding="5" Margin="0,0,10,0">
                    <System:String xmlns:System="clr-namespace:System;assembly=mscorlib">Idle</System:String>
                    <System:String xmlns:System="clr-namespace:System;assembly=mscorlib">BelowNormal</System:String>
                    <System:String xmlns:System="clr-namespace:System;assembly=mscorlib">Normal</System:String>
                    <System:String xmlns:System="clr-namespace:System;assembly=mscorlib">AboveNormal</System:String>
                    <System:String xmlns:System="clr-namespace:System;assembly=mscorlib">High</System:String>
                    <System:String xmlns:System="clr-namespace:System;assembly=mscorlib">RealTime</System:String>
                </ComboBox>

                <Button Command="{Binding SetPriorityCommand}" 
                        CommandParameter="{Binding SelectedItem, ElementName=PriorityCombo}"
                        Padding="10,5" Background="#0078D4" Foreground="White">
                    Zmień priorytet
                </Button>
            </StackPanel>
        </Grid>
    </Grid>
</UserControl>
